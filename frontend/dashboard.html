<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Football Performance Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/ag-grid-community/dist/ag-grid-community.min.js"></script>
    <style>
        :root {
            --primary: #1a472a;
            --secondary: #2a623d;
            --accent: #5d8aa8;
            --light: #f5f5f5;
            --dark: #121212;
            --gray: #71797E;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f0f2f5;
            color: #333;
        }
        
        .dashboard-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .dashboard-header {
            background-color: var(--primary);
            color: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .filters {
            background-color: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .filter-group {
            display: flex;
            flex-direction: column;
            min-width: 180px;
        }
        
        .filter-group label {
            font-weight: bold;
            margin-bottom: 5px;
            font-size: 0.9rem;
        }
        
        select, input {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .stat-card {
            background-color: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            text-align: center;
        }
        
        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: var(--primary);
            margin: 10px 0;
        }
        
        .stat-label {
            color: var(--gray);
            font-size: 0.9rem;
        }
        
        .charts-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .chart-card {
            background-color: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .chart-title {
            margin-top: 0;
            margin-bottom: 15px;
            color: var(--primary);
            font-size: 1.2rem;
        }
        
        .player-table-container {
            background-color: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            overflow-x: auto;
        }
        
        .ag-theme-alpine {
            --ag-header-background-color: var(--primary);
            --ag-header-foreground-color: white;
            --ag-border-color: #ddd;
            width: 100%;
            height: 400px;
        }
        
        @media (max-width: 768px) {
            .charts-container {
                grid-template-columns: 1fr;
            }
            
            .filters {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="dashboard-container">
        <div class="dashboard-header">
            <h1>Football Performance Dashboard</h1>
            <div id="last-update">Data loaded: Premier League 2023/24 Season</div>
        </div>
        
        <div class="filters">
            <div class="filter-group">
                <label for="team-filter">Team</label>
                <select id="team-filter">
                    <option value="all">All Teams</option>
                    <!-- Options will be populated dynamically -->
                </select>
            </div>
            
            <div class="filter-group">
                <label for="position-filter">Position</label>
                <select id="position-filter">
                    <option value="all">All Positions</option>
                    <option value="DF">Defender</option>
                    <option value="MF">Midfielder</option>
                    <option value="FW">Forward</option>
                    <option value="GK">Goalkeeper</option>
                </select>
            </div>
            
            <div class="filter-group">
                <label for="nation-filter">Nationality</label>
                <select id="nation-filter">
                    <option value="all">All Nations</option>
                    <!-- Options will be populated dynamically -->
                </select>
            </div>
            
            <div class="filter-group">
                <label for="metric-filter">Primary Metric</label>
                <select id="metric-filter">
                    <option value="goals_x">Goals</option>
                    <option value="assists_x">Assists</option>
                    <option value="expected_goals_x">Expected Goals</option>
                    <option value="successful_take_ons_x">Successful Take-ons</option>
                    <option value="progressive_passes_x">Progressive Passes</option>
                    <option value="minutes">Minutes Played</option>
                </select>
            </div>
            
            <div class="filter-group">
                <label for="search-player">Search Player</label>
                <input type="text" id="search-player" placeholder="Enter player name">
            </div>
        </div>
        
        <div class="stats-grid" id="stats-grid">
            <!-- Stat cards will be populated dynamically -->
        </div>
        
        <div class="charts-container">
            <div class="chart-card">
                <h3 class="chart-title">Team Performance Comparison</h3>
                <canvas id="team-performance-chart"></canvas>
            </div>
            
            <div class="chart-card">
                <h3 class="chart-title">Top Performers by Selected Metric</h3>
                <canvas id="top-performers-chart"></canvas>
            </div>
            
            <div class="chart-card">
                <h3 class="chart-title">Positional Analysis</h3>
                <canvas id="position-analysis-chart"></canvas>
            </div>
            
            <div class="chart-card">
                <h3 class="chart-title">Player Age Distribution</h3>
                <canvas id="age-distribution-chart"></canvas>
            </div>
        </div>
        
        <div class="player-table-container">
            <h3>Player Details</h3>
            <div id="player-table" class="ag-theme-alpine"></div>
        </div>
    </div>

    <script>
        // Sample data structure - in a real scenario, this would come from the Excel/JSON data
        const playerData = [
            {
                player: "Max Aarons", nation: "ENG", position: "DF", team: "Bournemouth", 
                age_x: 25, goals_x: 0, assists_x: 0, minutes: 86, touches_x: 73,
                expected_goals_x: 0, successful_take_ons_x: 0, progressive_passes_x: 8
            },
            {
                player: "Joshua Acheampong", nation: "ENG", position: "DF", team: "Chelsea", 
                age_x: 19, goals_x: 0, assists_x: 0, minutes: 170, touches_x: 137,
                expected_goals_x: 0.2, successful_take_ons_x: 1, progressive_passes_x: 8
            },
            {
                player: "Tyler Adams", nation: "USA", position: "MF", team: "Bournemouth", 
                age_x: 26, goals_x: 0, assists_x: 3, minutes: 1875, touches_x: 1279,
                expected_goals_x: 1.6, successful_take_ons_x: 3, progressive_passes_x: 71
            },
            {
                player: "Tosin Adarabioyo", nation: "ENG", position: "DF", team: "Chelsea", 
                age_x: 27, goals_x: 1, assists_x: 1, minutes: 1319, touches_x: 1255,
                expected_goals_x: 0.9, successful_take_ons_x: 4, progressive_passes_x: 39
            },
            {
                player: "Simon Adingra", nation: "CIV", position: "FW,MF", team: "Brighton", 
                age_x: 23, goals_x: 2, assists_x: 2, minutes: 1052, touches_x: 529,
                expected_goals_x: 2.4, successful_take_ons_x: 21, progressive_passes_x: 18
            },
            // More players would be added here from the dataset
        ];

        // Extract unique teams and nations for filters
        const teams = [...new Set(playerData.map(player => player.team))].sort();
        const nations = [...new Set(playerData.map(player => player.nation))].sort();

        // Populate team filter
        const teamFilter = document.getElementById('team-filter');
        teams.forEach(team => {
            const option = document.createElement('option');
            option.value = team;
            option.textContent = team;
            teamFilter.appendChild(option);
        });

        // Populate nation filter
        const nationFilter = document.getElementById('nation-filter');
        nations.forEach(nation => {
            const option = document.createElement('option');
            option.value = nation;
            option.textContent = nation;
            nationFilter.appendChild(option);
        });

        // Initialize charts
        const teamPerformanceChart = new Chart(
            document.getElementById('team-performance-chart'),
            {
                type: 'bar',
                data: {
                    labels: teams,
                    datasets: [
                        {
                            label: 'Average Goals per Game',
                            data: teams.map(team => {
                                const teamPlayers = playerData.filter(p => p.team === team);
                                return teamPlayers.reduce((sum, player) => sum + player.goals_x, 0) / teamPlayers.length;
                            }),
                            backgroundColor: 'rgba(54, 162, 235, 0.7)'
                        },
                        {
                            label: 'Average Assists per Game',
                            data: teams.map(team => {
                                const teamPlayers = playerData.filter(p => p.team === team);
                                return teamPlayers.reduce((sum, player) => sum + player.assists_x, 0) / teamPlayers.length;
                            }),
                            backgroundColor: 'rgba(255, 99, 132, 0.7)'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'top',
                        },
                        title: {
                            display: true,
                            text: 'Team Performance Comparison'
                        }
                    }
                }
            }
        );

        // Update charts based on filters
        function updateDashboard() {
            const selectedTeam = document.getElementById('team-filter').value;
            const selectedPosition = document.getElementById('position-filter').value;
            const selectedNation = document.getElementById('nation-filter').value;
            const selectedMetric = document.getElementById('metric-filter').value;
            const searchText = document.getElementById('search-player').value.toLowerCase();
            
            // Filter data based on selections
            let filteredData = playerData;
            
            if (selectedTeam !== 'all') {
                filteredData = filteredData.filter(player => player.team === selectedTeam);
            }
            
            if (selectedPosition !== 'all') {
                filteredData = filteredData.filter(player => player.position.includes(selectedPosition));
            }
            
            if (selectedNation !== 'all') {
                filteredData = filteredData.filter(player => player.nation === selectedNation);
            }
            
            if (searchText) {
                filteredData = filteredData.filter(player => 
                    player.player.toLowerCase().includes(searchText)
                );
            }
            
            // Update stats grid
            updateStatsGrid(filteredData);
            
            // Update charts
            updateCharts(filteredData, selectedMetric);
            
            // Update player table
            updatePlayerTable(filteredData);
        }

        // Set up event listeners for filters
        document.getElementById('team-filter').addEventListener('change', updateDashboard);
        document.getElementById('position-filter').addEventListener('change', updateDashboard);
        document.getElementById('nation-filter').addEventListener('change', updateDashboard);
        document.getElementById('metric-filter').addEventListener('change', updateDashboard);
        document.getElementById('search-player').addEventListener('input', updateDashboard);

        // Initialize the dashboard
        updateDashboard();
    </script>
</body>
</html>