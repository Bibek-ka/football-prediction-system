{% extends 'frontend/base.html' %} {% load static %} {% block title %}Sign Up | Football Match Prediction{% endblock %} {% block extra_css %} <style> :root { --primary: #3d5a80; --secondary: #98c1d9; --accent: #ee6c4d; --light: #e0fbfc; --dark: #293241; } body { background: linear-gradient(135deg, var(--primary) 0%, var(--dark) 100%); min-height: 100vh; display: flex; align-items: center; justify-content: center; padding: 20px; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; } .signup-container { width: 100%; max-width: 500px; } .form-box { background: white; padding: 2.5rem; border-radius: 12px; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2); transition: transform 0.3s ease; } .form-box:hover { transform: translateY(-5px); } .logo { text-align: center; margin-bottom: 1.5rem; } .logo i { font-size: 2.5rem; color: var(--accent); background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%); background-clip: text; -webkit-background-clip: text; -webkit-text-fill-color: transparent; } h2 { text-align: center; color: var(--dark); margin-bottom: 1.8rem; font-weight: 700; } .form-label { font-weight: 600; color: var(--dark); margin-bottom: 0.5rem; } .form-control { padding: 0.8rem 1.2rem; border: 2px solid #ddd; border-radius: 8px; transition: all 0.3s; } .form-control:focus { border-color: var(--secondary); box-shadow: 0 0 0 0.25rem rgba(152, 193, 217, 0.25); } .input-group-text { background: transparent; border: 2px solid #ddd; border-right: none; } .password-toggle { cursor: pointer; color: var(--secondary); background: transparent; border: 2px solid #ddd; border-left: none; } .btn-signup { background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%); color: white; padding: 0.8rem; border: none; border-radius: 8px; font-weight: 600; width: 100%; margin-top: 1rem; transition: all 0.3s; } .btn-signup:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2); } .switch-link { text-align: center; margin-top: 1.5rem; color: var(--dark); } .switch-link a { color: var(--accent); text-decoration: none; font-weight: 600; transition: all 0.3s; } .switch-link a:hover { text-decoration: underline; } .alert { border-radius: 8px; padding: 0.8rem 1.2rem; margin-bottom: 1.2rem; } .password-rules { font-size: 0.8rem; color: #6c757d; margin-top: 0.4rem; } .form-check-input:checked { background-color: var(--accent); border-color: var(--accent); } .verification-container { display: none; text-align: center; } .verification-input { display: flex; justify-content: center; gap: 10px; margin: 20px 0; } .verification-input input { width: 45px; height: 55px; text-align: center; font-size: 24px; border: 2px solid #ddd; border-radius: 8px; } .resend-link { cursor: pointer; color: var(--accent); font-weight: 600; } </style> {% endblock %} {% block content %} <div class="signup-container"> <div class="form-box"> <div class="logo"> <i class="fa-solid fa-futbol"></i> </div> <div id="signup-section"> <h2>Create Your Account</h2> <div id="alert-container"></div> <form id="signup-form"> {% csrf_token %} <div class="mb-3"> <label for="username" class="form-label">Username</label> <input type="text" class="form-control" id="username" name="username" required placeholder="Enter your username"> </div> <div class="mb-3"> <label for="email" class="form-label">Email Address</label> <input type="email" class="form-control" id="email" name="email" required placeholder="Enter your email"> </div> <div class="mb-3"> <label for="password" class="form-label">Password</label> <div class="input-group"> <input type="password" class="form-control" id="password" name="password" required placeholder="Create a strong password"> <span class="input-group-text password-toggle" id="password-toggle"> <i class="fa fa-eye"></i> </span> </div> <div class="password-rules"> Must be at least 8 characters with uppercase, lowercase, and number </div> </div> <div class="mb-3"> <label for="confirm_password" class="form-label">Confirm Password</label> <div class="input-group"> <input type="password" class="form-control" id="confirm_password" name="confirm_password" required placeholder="Confirm your password"> <span class="input-group-text password-toggle" id="confirm-password-toggle"> <i class="fa fa-eye"></i> </span> </div> </div> <div class="mb-3 form-check"> <input type="checkbox" class="form-check-input" id="terms" required> <label class="form-check-label" for="terms">I agree to the <a href="#">Terms of Service</a> and <a href="#">Privacy Policy</a></label> </div> <button type="submit" class="btn btn-signup" id="signup-button"> <span class="button-text">Sign Up</span> <div class="button-spinner spinner-border spinner-border-sm text-light" role="status" style="display: none;"> <span class="visually-hidden">Loading...</span> </div> </button> </form> <p class="switch-link"> Already have an account? <a href="{% url 'login' %}">Login here</a> </p> </div> <div id="verification-section" class="verification-container"> <h2>Verify Your Email</h2> <p>We've sent a 6-digit verification code to <span id="email-display" class="fw-bold">user@example.com</span></p> <div class="verification-input"> <input type="text" maxlength="1" data-index="0" oninput="moveToNext(this)"> <input type="text" maxlength="1" data-index="1" oninput="moveToNext(this)"> <input type="text" maxlength="1" data-index="2" oninput="moveToNext(this)"> <input type="text" maxlength="1" data-index="3" oninput="moveToNext(this)"> <input type="text" maxlength="1" data-index="4" oninput="moveToNext(this)"> <input type="text" maxlength="1" data-index="5" oninput="moveToNext(this)"> </div> <button type="button" class="btn btn-signup" id="verify-button"> <span class="button-text">Verify Email</span> <div class="button-spinner spinner-border spinner-border-sm text-light" role="status" style="display: none;"> <span class="visually-hidden">Loading...</span> </div> </button> <p class="mt-3">Didn't receive the code? <span class="resend-link" id="resend-code">Resend code</span></p> </div> </div> </div> {% endblock %} {% block extra_js %} <script> // Global variables to store user data let userData = {}; document.addEventListener('DOMContentLoaded', function() { const signupForm = document.getElementById('signup-form'); const signupSection = document.getElementById('signup-section'); const verificationSection = document.getElementById('verification-section'); const alertContainer = document.getElementById('alert-container'); const signupButton = document.getElementById('signup-button'); const buttonText = document.getElementById('button-text'); const buttonSpinner = document.getElementById('button-spinner'); const passwordToggle = document.getElementById('password-toggle'); const confirmPasswordToggle = document.getElementById('confirm-password-toggle'); const verifyButton = document.getElementById('verify-button'); const verifyButtonText = document.getElementById('verify-button-text'); const verifyButtonSpinner = document.getElementById('verify-button-spinner'); const emailDisplay = document.getElementById('email-display'); const resendCodeLink = document.getElementById('resend-code'); // Check if already logged in if (FootballApp.isAuthenticated()) { window.location.href = "{% url 'profile' %}"; } // Toggle password visibility function setupPasswordToggle(toggleElement, inputId) { toggleElement.addEventListener('click', function() { const input = document.getElementById(inputId); const icon = this.querySelector('i'); if (input.type === 'password') { input.type = 'text'; icon.classList.remove('fa-eye'); icon.classList.add('fa-eye-slash'); } else { input.type = 'password'; icon.classList.remove('fa-eye-slash'); icon.classList.add('fa-eye'); } }); } setupPasswordToggle(passwordToggle, 'password'); setupPasswordToggle(confirmPasswordToggle, 'confirm_password'); // Validate password strength function validatePassword(password) { const minLength = 8; const hasUpperCase = /[A-Z]/.test(password); const hasLowerCase = /[a-z]/.test(password); const hasNumbers = /\d/.test(password); return password.length >= minLength && hasUpperCase && hasLowerCase && hasNumbers; } // Validate email format function validateEmail(email) { const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/; return re.test(email); } // Form submission handler signupForm.addEventListener('submit', async function(e) { e.preventDefault(); const username = document.getElementById('username').value.trim(); const email = document.getElementById('email').value.trim(); const password = document.getElementById('password').value.trim(); const confirm = document.getElementById('confirm_password').value.trim(); // Basic validation if (!username) { FootballApp.showAlert('Please enter a username', 'danger'); return; } if (username.length < 3) { FootballApp.showAlert('Username must be at least 3 characters long', 'danger'); return; } if (!validateEmail(email)) { FootballApp.showAlert('Please enter a valid email address', 'danger'); return; } if (!validatePassword(password)) { FootballApp.showAlert('Password must be at least 8 characters with uppercase, lowercase, and number', 'danger'); return; } if (password !== confirm) { FootballApp.showAlert('Passwords do not match', 'danger'); return; } // Store user data for verification userData = { username, email, password }; // Show loading state FootballApp.setButtonLoading(signupButton, true); try { // Register user with backend const response = await FootballApp.apiRequest('/auth/register/', { method: 'POST', body: JSON.stringify({ username: username, email: email, password: password, role: 'user' }) }); // Show verification section signupSection.style.display = 'none'; verificationSection.style.display = 'block'; emailDisplay.textContent = email; FootballApp.showAlert('Registration successful! Please check your email for verification code.', 'success'); } catch (error) { console.error('Registration error:', error); FootballApp.showAlert(error.message || 'Registration failed. Please try again.', 'danger'); } finally { // Reset button state FootballApp.setButtonLoading(signupButton, false); } }); // Verification code input navigation window.moveToNext = function(field) { if (field.value.length >= field.maxLength) { const nextField = field.nextElementSibling; if (nextField) nextField.focus(); } }; // Verify button handler verifyButton.addEventListener('click', async function() { // Get the verification code const inputs = document.querySelectorAll('.verification-input input'); let verificationCode = ''; inputs.forEach(input => { verificationCode += input.value; }); if (verificationCode.length !== 6) { FootballApp.showAlert('Please enter the complete 6-digit code', 'danger'); return; } // Show loading state FootballApp.setButtonLoading(verifyButton, true); try { // First, we need to login to get a token for verification const loginResponse = await FootballApp.apiRequest('/auth/login/', { method: 'POST', body: JSON.stringify({ username: userData.username, password: userData.password }) }); // Now verify the code using the token const verifyResponse = await FootballApp.apiRequest('/auth/verify-code/', { method: 'POST', headers: { 'Authorization': Bearer ${loginResponse.access} }, body: JSON.stringify({ code: verificationCode }) }); FootballApp.showAlert('Email verified successfully! Redirecting to login page...', 'success'); // Redirect to login page after a delay setTimeout(() => { window.location.href = "{% url 'login' %}"; }, 1500); } catch (error) { console.error('Verification error:', error); FootballApp.showAlert(error.message || 'Verification failed. Please try again.', 'danger'); } finally { // Reset button state FootballApp.setButtonLoading(verifyButton, false); } }); // Resend code handler resendCodeLink.addEventListener('click', async function() { // Show loading state FootballApp.setButtonLoading(verifyButton, true); resendCodeLink.style.pointerEvents = 'none'; try { // Login to get token for resending code const loginResponse = await FootballApp.apiRequest('/auth/login/', { method: 'POST', body: JSON.stringify({ username: userData.username, password: userData.password }) }); // Resend verification code await FootballApp.apiRequest('/auth/send-code/', { method: 'POST', headers: { 'Authorization': Bearer ${loginResponse.access} } }); FootballApp.showAlert('Verification code sent successfully!', 'success'); // Clear previous inputs const inputs = document.querySelectorAll('.verification-input input'); inputs.forEach(input => { input.value = ''; }); inputs[0].focus(); } catch (error) { console.error('Resend error:', error); FootballApp.showAlert('Failed to resend verification code. Please try again.', 'danger'); } finally { // Reset button state FootballApp.setButtonLoading(verifyButton, false); // Enable resend after 30 seconds resendCodeLink.style.pointerEvents = 'none'; let countdown = 30; const originalText = resendCodeLink.textContent; const interval = setInterval(() => { resendCodeLink.textContent = Resend code (${countdown}); countdown--; if (countdown < 0) { clearInterval(interval); resendCodeLink.textContent = originalText; resendCodeLink.style.pointerEvents = 'auto'; } }, 1000); } }); }); </script> {% endblock %}